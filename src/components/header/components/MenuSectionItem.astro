---
import { getRelativeLocaleUrl } from 'astro:i18n';

export interface SubItemProps {
  label: string;
  description?: string;
  href: string;
}

export interface Props {
  iconSrc: string;
  iconAlt: string;
  label: string;
  description: string;
  href: string;
  subItems?: SubItemProps[];
}

const { iconSrc, iconAlt, label, description, href, subItems } = Astro.props;
const locale = Astro.currentLocale!;
const localizedHref = href ? getRelativeLocaleUrl(locale, href) : href;
---

<div class={`
  flex
  flex-col
`}>
  <a
    href={localizedHref}
    class={`
      group/item
      -mx-2.5
      flex
      items-start
      gap-2
      rounded-[8px]
      px-2.5
      py-1.5
      transition-colors
      hover:bg-gray-100
    `}
  >
    <span class={`
      mt-0.5
      flex
      size-9
      shrink-0
      items-center
      justify-center
      rounded-[4px]
      bg-primary
      text-muted
      transition-colors
      lg:group-hover/item:text-foreground
    `}>
      <img
        src={iconSrc}
        alt={iconAlt}
        width="36"
        height="36"
        loading="lazy"
        decoding="async"
        class={`
          h-full
          w-full
        `}
      />
    </span>
    <div class={`
      flex
      flex-col
      gap-0.5
    `}>
      <span class={`
        text-sm
        font-medium
        text-foreground
      `}>
        {label}
      </span>
      <span class={`
        text-xs
        leading-snug
        text-footnote
      `}>
        {description}
      </span>
    </div>
  </a>
  {subItems && subItems.length > 0 && (
    <div class={`
      relative
      ml-4
      flex
      flex-col
      gap-1
      pb-2
      pl-2
      before:absolute
      before:top-0
      before:left-0
      before:h-[calc(100%-12px)]
      before:w-px
      before:bg-separator
    `}>
      {subItems.map((subItem: SubItemProps) => (
        <a
          href={subItem.href ? getRelativeLocaleUrl(locale, subItem.href) : subItem.href}
          class={`
            flex
            flex-col
            py-1
            transition-colors
            lg:hover:text-foreground
          `}
        >
          <span class={`
            text-xs
            font-medium
            text-foreground
          `}>
            {subItem.label}
          </span>
          {subItem.description && (
            <span class={`
              text-[11px]
              leading-snug
              text-footnote
            `}>
              {subItem.description}
            </span>
          )}
        </a>
      ))}
    </div>
  )}
</div>
