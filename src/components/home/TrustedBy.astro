---
import { getLangFromUrl, useTranslations } from '@/i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const placeholders = [
  { color: '#a48c7e', width: 100 },
  { color: '#8b7355', width: 120 },
  { color: '#6a4d42', width: 90 },
  { color: '#a48c7e', width: 110 },
  { color: '#8b7355', width: 100 },
  { color: '#6a4d42', width: 130 },
];
---

<section
  aria-label={t('trustedBy.ariaLabel')}
  class={`
    flex
    w-full
    items-center
    gap-4
    py-16
    pr-0
    sm:gap-8
    sm:py-20
    md:gap-12
    lg:pl-6
  `}
>
  <p class={`
    hidden
    flex-2
    font-normal
    text-espresso
    lg:block
    lg:text-base
  `}>
    {t('trustedBy.description')}
  </p>

  <div class={`
    relative
    flex-3
    overflow-hidden
  `}>
    <!--
      Easing gradient for smoother fade-out transition
      Generated with: https://larsenwork.com/easing-gradients/
      Input: hsl(0, 0%, 98%) to transparent, ease-in-out
    -->
    <div
      class={`
        pointer-events-none
        absolute
        inset-y-0
        left-0
        z-10
        hidden
        w-24
        md:w-32
        lg:block
      `}
      style="background: linear-gradient(to right, hsl(0, 0%, 98%) 0%, hsla(0, 0%, 98%, 0.987) 8.1%, hsla(0, 0%, 98%, 0.951) 15.5%, hsla(0, 0%, 98%, 0.896) 22.5%, hsla(0, 0%, 98%, 0.825) 29%, hsla(0, 0%, 98%, 0.741) 35.3%, hsla(0, 0%, 98%, 0.648) 41.2%, hsla(0, 0%, 98%, 0.55) 47.1%, hsla(0, 0%, 98%, 0.45) 52.9%, hsla(0, 0%, 98%, 0.352) 58.8%, hsla(0, 0%, 98%, 0.259) 64.7%, hsla(0, 0%, 98%, 0.175) 71%, hsla(0, 0%, 98%, 0.104) 77.5%, hsla(0, 0%, 98%, 0.049) 84.5%, hsla(0, 0%, 98%, 0.013) 91.9%, hsla(0, 0%, 98%, 0) 100%);"
      aria-hidden="true"
    ></div>

    <!-- Scrolling track -->
    <div
      class={`
        flex
        w-max
        animate-marquee-logos
        gap-4
        pr-4
        motion-reduce:animate-none
        sm:gap-8
        sm:pr-8
        md:gap-12
        md:pr-12
      `}
      aria-hidden="true"
    >
      <!-- First set of logos -->
      {
        placeholders.map((p) => (
          <div
            style={`background: ${p.color}; width: ${p.width}px`}
            class={`
              h-7
              shrink-0
              rounded-sm
              opacity-60
              sm:h-10
              md:h-12
            `}
            aria-hidden="true"
          />
        ))
      }
      <!-- Duplicate for seamless loop -->
      {
        placeholders.map((p) => (
          <div
            style={`background: ${p.color}; width: ${p.width}px`}
            class={`
              h-7
              shrink-0
              rounded-sm
              opacity-60
              sm:h-10
              md:h-12
            `}
            aria-hidden="true"
          />
        ))
      }
    </div>
  </div>
</section>
